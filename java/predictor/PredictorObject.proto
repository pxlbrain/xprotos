syntax = "proto3";
package ai.pixlbrain.backend;

enum ModelDeploymentType {
    LOCAL = 0;
    HOST = 1;
};

message MessageUnit {
    string message = 1;
    string requestId = 2;
};

message ImagePaths {
    repeated string imagePaths = 1;
};

message PredictorResponse {
    MessageUnit message = 1;
};

message PredictorRequest {
    ImagePaths imagePaths = 1;
    SchemaRequest schema = 2;
    string client = 3;
    string location = 4;
    string modelType = 5;
    double threshold = 6;
    double detector_threshold = 7;
    double mlc_threshold = 8;
    double classifier_threshold = 9;
    string product_list_path = 10;
    string segments_rule_path = 11;
};

message ServiceParams {
    string protocol = 1;
    string host = 2;
    string model_name = 3;
};

message bbx{
    int32 x1 = 1;
    int32 y1 = 2;
    int32 x2 = 3;
    int32 y2 = 4;
};

message Params{
    string protocol = 1;
    string host = 2;
    ModelDeploymentType model_deployment_type = 3;
    string model_name = 4;
    double threshold = 5;
    bbx roi = 6;
    string category = 7;
    string product_list_path = 8;
    string model_type = 9;
    string segments_rule_path = 10;

};

message NodeUnit {
    int32 _id = 1;
    string type = 2;
    string name = 3;
    repeated int32 next = 4;
    Params params = 5;
};

message SchemaRequest {
    repeated NodeUnit nodes = 1;
};

message FilterPredictorRequest{
    SchemaRequest schema = 1;
    string client = 2;
    string location = 3;
    string filter = 4;
    string modelType = 5;
    string product_list_path = 6;
};

message StopTestingRequest{
    string requestId = 1;
};